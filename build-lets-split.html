<!DOCTYPE html>
<html lang="ja">

<head>
      <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Let's Split (レツプリ) を組み立てた</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />

  <!-- Feed -->
        <link href="http://shufo.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="shufo blog Full Atom Feed" />
          <link href="http://shufo.github.io/feeds/keyboard.atom.xml" type="application/atom+xml" rel="alternate" title="shufo blog Categories Atom Feed" />

  <link href="http://shufo.github.io/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="http://shufo.github.io/theme/css/code_blocks/tomorrow_night.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->


    <link href="http://shufo.github.io/build-lets-split.html" rel="canonical" />

        <meta name="description" content="レツプリを組み立てた話">

        <meta name="author" content="shufo">

        <meta name="tags" content="DIY">
        <meta name="tags" content="keyboard">
        <meta name="tags" content="自作キーボード">

        <meta property="og:locale" content="" />
    <meta property="og:site_name" content="shufo blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="shufo blog" />
    <meta property="og:description" content="Random automation stuff" />
    <meta property="og:url" content="http://shufo.github.io" />
      <meta property="og:image" content="http://shufo.github.io/assets/header.jpg" />

  <meta property="og:type" content="article">
            <meta property="article:author" content="http://shufo.github.io/author/shufo">
  <meta property="og:url" content="http://shufo.github.io/build-lets-split.html">
  <meta property="og:title" content="Let's Split (レツプリ) を組み立てた">
  <meta property="article:published_time" content="2018-01-08 00:00:00+09:00">
            <meta property="og:description" content="レツプリを組み立てた話">

                <meta property="og:image" content="https://i.imgur.com/zEWMnD8.jpg">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@shufo_">
        <meta name="twitter:title" content="Let's Split (レツプリ) を組み立てた">
        <meta name="twitter:url" content="http://shufo.github.io/build-lets-split.html">

                <meta name="twitter:image:src" content="https://i.imgur.com/zEWMnD8.jpg">

            <meta name="twitter:description" content="レツプリを組み立てた話">
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="/hello-world.html" role="presentation">About</a></li>
          <li><a href="/archives/" role="presentation">Archives</a></li>
          <li><a href="./categories.html" role="presentation">Categories</a></li>
          <li><a href="https://github.com/shufo" role="presentation">GitHub</a></li>
          <li><a href="/feeds/all.atom.xml" role="presentation">XML</a></li>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="http://shufo.github.io" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Let's Split (レツプリ) を組み立てた</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="http://shufo.github.io/author/shufo">Shufo</a>
            | <time datetime="2018 Jan/08 (Mon)">2018 Jan/08 (Mon)</time>
        </span>
        <!-- TODO : Modified check -->
        
            <div class="post-cover cover" style="background-image: url('https://u6ixvg.ch.files.1drv.com/y4mLfKNMawH4ubEowYh-8FARCykY9b6eRKWdZ8hw_eEJcNoQT-yXqxYvspmdnUjZnJydyewy-7r6tOh2eBF7eT2971-Q1w9lGMJ4AU_ujoGQcUUSkbYehZXST-aJJFCBexTGC06YIosebBsTnmP0fGPmUb_lcxbQm-mIh-j9a2A4ywTrDKPF3n4uF3eWtMc-pFzYYk2WDYqogjASzkWcFoOrw?width=4160&height=3120&cropmode=none')">
        
      </div>
    </header>    

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>昨今の自作キーボードブームと格子配列型で左右分割のキーボードを試してみたくなったので昨年よく見かけたレツプリを作ってみることにした</p>
<h2>必要なもの</h2>
<ul>
<li>Let's Split PCB x 2</li>
<li>Pro micro x 2</li>
<li>スイッチ x 48 <a href="https://www.aliexpress.com/item/kailh-pro-switches-3pin-RGB-SMD-purple-light-green-teal-aqua-burgundy-MX-RGB-Swithes-For/32838033039.html?spm=a2g0s.9042311.0.0.lT90up">Kailh Pro Switche Burgundy</a></li>
<li>TRRS ジャック x 2</li>
<li>TRRS ケーブル</li>
<li>ダイオード x 48</li>
<li>ケース(top プレートと bottom プレート)</li>
<li>ネジとスタンド</li>
<li>LED ケーブル x 1 [<a href="https://www.switch-science.com/">Switch Science</a>]</li>
<li>タクトスイッチ x 2 [Switch Science]</li>
<li>リード線 [Amazon]</li>
<li>3M クッションゴム [Amazon]</li>
<li>はんだごてセット [Amazon]</li>
</ul>
<p>今回は<a href="https://mehkee.com/">Mehkee</a>でレツプリの<a href="https://mehkee.com/collections/keyboards/products/lets-split-acrylic-cases-kits?variant=46981199311">セット</a>が売っていたので最初に必用なパーツはある程度揃える事が出来た</p>
<p>クッションゴム, タクトスイッチ, リード線、LED ケーブルはなかったので別途買った</p>
<h2>組み立て</h2>
<p>幸い先人たちのビルドログが結構な数あったので途中で詰まることはあまりなかった</p>
<h3>ダイオードハンダ付け</h3>
<p>それぞれ+-の方向だけ気をつけてハンダ付け。ダイオードの黒い方のリード線が四角い穴に入るようにする。</p>
<p><img src="https://gaaasw.ch.files.1drv.com/y4m1jARiYKevuzhzusO6jJ8wPdIbbNPbzkkYZHw0pu-tl8cFUlVv1Vrbu0KbQ1ERLsMbeTdPnjUyN9DVr8XMqkmAIRmiOp6mFGe7mLyfPRK5sMsTRBYQHpjEZrj2KkT7a2TArf8chzK33vnxI9PrhaMXI9ym7TGHdMVP-QnbWZQcDUHTJRysWbRqY6ggMCWr2_9Oaxvyi9z4C3WLNiB1ivlPA?width=1440&height=1080&cropmode=none" width="1440" height="1080" /></p>
<p><img src="https://iqbl1g.ch.files.1drv.com/y4m7Fs5CBMUaGnv8q3IisbBbepE1D4AbrEc296TJdNPqJEOWYy9p2G4CVJNjGrUhRXDUASDHZcv-sIUoHvL9XbqeN786dSDReb890_bOu4N1zGbn8lLnJTPCmsVSQjEV85bBkyQ2nelmSI12gsXDNLQkpQl_r_g9SwRPNwmSJodHPJSwO-cjz2wNKp7-dUVOVrxlFA4aSk_7Zzut3YK9TTW1A?width=1440&height=1080&cropmode=none" width="1440" height="1080" /></p>
<h3>TRRS ジャック取り付け</h3>
<p><img src="https://gqaasw.ch.files.1drv.com/y4mxf1_q7YLEL3iYck7oRBTGC4PzSOwLRBfxe_g-j6k9P19EavN_yOB3x_9G_8zCeXobCrzFML70YLiXqN2pXkipsrYZmK4wk-3b4kjWCvvI453J3AbouwkY_4rKAAXS5Vvz3rJwhjmKv8Lx3SNyU5qBIYJ9CxduFoUY5T0iiIJDJWu4RtjJhxXb80LZgsokJJT2d6_PD8L7WyD8PqdqHB97w?width=1440&height=1080&cropmode=none" width="1440" height="1080" /></p>
<p><img src="https://igaasw.ch.files.1drv.com/y4m8yzp4MEmVM-rBrQ7MbrdXfJI9C3koY5tRdBP98f4pnxV_gOIy8r2KHpUNimtJW_AiZdraMPTDmkVJ3Xk8xD99ab0Xqdf8g9Hk4_zy4JnypcFtxopwVHy5pUOZpGhe9N8FJYill3pQAj2uEI3qB_kDs5DsZUfnwHhm3VJ8MSzyt6eHuUetbTZbreTHnQBz2zKqm11JjtWBx6Ug86S_lcHlg?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<h3>ジャンパー接続</h3>
<p>公式から引用。以下の要領で PCB の TRRS ジャック下のに空いてる箇所をハンダで接続する</p>
<div class="highlight"><pre><span></span>VCC [x]     [ ] VCC
    [x]     [x]
GND [ ]     [x] GND
</pre></div>


<p><img src="https://jabl1g.ch.files.1drv.com/y4m_8f2vgBCB3MmpwtKz4wBRiYAoCtmQoqS0WiyLbEOsqX9x5dt5JeX0_56u2UfNtKmCJwsyz2lwskcKKigd1kcoXE3TGEBfWsMacPM0hG3RSSe5KJ4t-PnU4ku8hEh7DARKS6ptIJzGa44kma2nUwOwz-tAyCPspVnBg5b4RkW5-yCpqlINLKU9fwQid-riexK4lJpQ6hrbmlfIV--eIwdTg?width=1503&height=1127&cropmode=none" width="1503" height="1127" /></p>
<h3>ヘッダーピン取り付け</h3>
<p>Pro Micro 付属のヘッダーピンを取り付ける。足の長い方を TRRS ジャックと同じ側にして差し込む。足の短い表側をハンダ付けしておく。</p>
<p><img src="https://jaaasw.ch.files.1drv.com/y4m7GJqIcbAhnM0nX8C96lB3Q2wb3XwbRC9gqN2kS-Q09ijWyW8sdoORQhLH07kAI_SR50sL6bjYtvih2otF3pdyPrHxKMQATL7ZIbEaxA9IDRwi1KA7lrM5EEKmKXmmKJnWjNMuEXRFjwLbw7URqrtfMMFLA8e0SgG7Q4878Lc_KW7LqJkdpDkRd4cDSqRbp2HiVldYpqeG8OEjgcxVS9BpQ?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<h3>先に２つスイッチをつける</h3>
<p>Pro Micro と位置が被るので Pro Micro の位置のスイッチ 2 つは先に実装する。</p>
<p>上側のケースを挟みこむようにしてスイッチを取り付ける。</p>
<p><img src="https://hgaasw.ch.files.1drv.com/y4mc2BP86AEgyrKSczYwuB2xd4eoBKNQ4KhquoY7mk4DPs-6cHcwDGOmpILzn0nfm7CVf0NTdEUt5cagf4D_lOhdOkKHuhMDtDhB80rMRNE-HTh4STIXGPEW_U_7cuQqxEAXY3pdp0LK_ZHKX5GNr6mmGLDHDlYhMyscJhDtjsZsOjiN1ji-4sUF2zkuIjG8QAxGZ_gsGnbIF4ajUBEToMcTQ?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<p>スイッチを差し込むと PCB のパンダの目のようなとこにスイッチの足が出るのでハンダ付け。ここがしっかり接続されていないとキーを押したのに反応しないというようなことが起こるので注意。特に Pro Micro を取り付けた後だとここのハンダは修正出来ないのでハンダがちゃんと浸透してるか見ておいた方がいい。</p>
<h3>Pro Micro 取り付け</h3>
<p>Pro Micro を実装する。それぞれ左右で表裏を変えないといけないので注意。</p>
<p>左手側(TRRS ジャックが右に来る方)は実装面が上に来るようにして実装。Pro Micro から飛び出した長い足はニッパーで切ってハンダ付け。</p>
<p><img src="https://iqaasw.ch.files.1drv.com/y4mGkc4xtrqV5YE1GZz9Ot8be8M00g0_fwgRRlmHKfXRMsEEgosB20gxHUIV9AQzJ-bM_S_iqpu3jhgJlT9FcHLA7n5U80ZrGAzqp_AQzP8BftTr2PXzMRaeYR3idP1YvnkUmKsb2k8NbFb2CSdAokDNuCsY2Og1J7DPdpr6y6WZCEUQQUi1WApp7zAMmm8bWZKX8gv9Gs8KS2ak8UuqjQFrQ?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<p>右手側(TRRS ジャックが左に来る方)は裏側を表にして実装。</p>
<p><img src="https://iaaasw.ch.files.1drv.com/y4m9jLjzUJJawBh8NlfNBmwXRg-JofQmUFjHEOgXskkbaTKk6UlE_yonASXdL3oLKHHUDNZytGyKWxnRr39KXuuA7VXCLc3_q6x523ZLOCPPERRweTx_kCTRWHLOdeXKeOyPgAU1ZlBsz7iCpXwQRKIeTtav4tJEcctRsi5KwQloEU0W0HEI-G-CCGAG5LDRojAU5dFHN2jdw02o9qCri6fkg?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<h3>スイッチ取り付け</h3>
<p>残りのスイッチを全て取り付ける。</p>
<p><img src="https://gaybwa.ch.files.1drv.com/y4mhwUF-UokW-i4HMxpXoACH1VMM8BqXjEKE0H4PaCd18Kiic9u7npca62IboQdXiUvNJp9Vp0mmnCxHcnWXju0lp42Cah5za_5PyPfSh6l47z4q6G2lDFLDM2zJoXEa_AmXu72GU4zGbNDVWTzYSSeXDRpMDHPBA-534Vlq3UuguTfxMwzYbd9kj-0KDyYEnD1lOnBtZlq9fnmG_-ph5QdIA?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<p>ハンダ付け後。同じくハンダ付けが甘いとキー押下時の認識が甘くなるのでちゃんとハンダ付けする。</p>
<p><img src="https://gqybwa.ch.files.1drv.com/y4mLN753LmIQu1V992WSp6VrK7ysOsc-VukF8zXCBVt-xiPPBOByJ0lyg6Uz7PxsPNO8cqY-g5_zRu7l6G84mLKfuRaWNzkMaoydb0bSUYdbOynM5f52beoyaiT7zWNGN65WPg6S4GjgVbOD0Rdk-EPcEXJWcDm_A7R2KYptZ6XLIcoIWP2M41wSHNwr0VJ1mG307GjJ0A3N7rZfrIOVK8B7Q?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<h3>タクトスイッチ取り付け</h3>
<p>ファームウェアを書き込む時に GNC と RST をショートさせる必要があるため、ボタン操作でリセット出来るようにタクトスイッチを取り付ける。それぞれ GND と RST をタクトスイッチの足にハンダ付け。</p>
<p><img src="https://iwybwa.ch.files.1drv.com/y4m5jLAqCvWcOQblxIMaTcd9knX-m2XqWKSG_duQ-fORXu0o3sDmdD_hC52x-xnWzBYo1N9JlQsbG_Y9YW8REIi8c3a70YzGwnxGgMn2X5ehzvbSVjt2Ew5pAziG0KPQzO5OZFJc1cv6wayFoxsIcM4Rx_D-Q_R6hozLbGq4aEGQO8c8j0BEm8EK1W4xQPs9sZAx8NaBGpwPha1L635N4hHkA?width=3120&height=4160&cropmode=none" width="3120" height="4160" /></p>
<p><img src="https://jaybwa.ch.files.1drv.com/y4mrmJWnLXTyVzF3vQW3WnTnEabbeofN-OBNcGjf3Ka2HO7WAUGzQT0TuHE7FBUtcQ4Od6GfthJWNctxtYjxVYzx8bC7O3eZImQ5c_REwInl00efvmpc1Hx-tktO97ncd3EyGICnPjl88IJ73bTk8UVd0xWSTi-CWV0rwpaM54wV-r67dA3wvjy-hTTLZYkEmeH5Pm09pu53KjYAw2Rplz3FA?width=3120&height=4160&cropmode=none" width="3120" height="4160" /></p>
<h3>LED 実装</h3>
<p>一応ここまでで既にキーボードは動作するが光の民ゆえ光らせたいので LED を実装する。光の民って何。</p>
<p>Switch Science で買った LED（１７ｃｍ）をハサミで２つに切ってそれぞれ実装する。</p>
<p><img src="https://iaybwa.ch.files.1drv.com/y4mRKqpbFxku7gKCZhJghVjULduUSHpxFpK7PQ_ArX28a1Ghumaknc5iWxkSIdU-CZjQvAt4_b-MblTESka0_o83n3A0AOP_snyQFM_gqD57_swFg0O1ebbrGj_XbqzqsXJfW1qtkeE5ViNdCZKexYxI1hka6ahRHARrylt1hvMBIUSGQck9mnf6UdBQ4mTIccgzU4Qv-KrHjauJVVKrqlFcw?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<p>たぶんここが一番苦労した。リード線に予備ハンダをして線をメッキしてからハンダ付け箇所でリード線に付着したハンダを溶かして付着させると楽かもしれない。</p>
<p>右手側は GND -&gt; GND, +5V -&gt; VCC, DI -&gt; extra data で接続する。</p>
<p><img src="https://skixvg.ch.files.1drv.com/y4mrI_iwEgfR1VIiVU1DBj9TxeZdbQvlmicJijTASkPwx3cxz4ZsTFp0BZPoo419AVifnyHn0Aj0BezXXMERFReAZgILWcMqlgJu2VbsChdhDDnaoUheIXXEDm7n8c4VPbsYemwBCdOJ9-2I69HQeXLbZgTeweD1sh1T0E1qjuo1rZmkpOlZCf4flq4ajYlGR1BQoCWyXMhDW9QIaPK9bzvow?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<p>左手側はそれぞれ左は+5V -&gt; VCC, DO -&gt; extra data, GND -&gt; GND. 右側は DIN -&gt; TX0 pin, GND -&gt; GND, +5V -&gt; VCC で接続する。</p>
<p><img src="https://uaixvg.ch.files.1drv.com/y4mQKyOuuUal6JLuePdC_lM_Gb6561jeZRFFeSco83hq4iTx3shQTpEVyfT_M1xDtEVi7zTfG0Z-KDpAg7015xaHxMcl1X9ULUDf7jOAp1VTV88k6B5YAIuzyfeE_2cSv0p8CenMGfOQFmgBv3VhBqThdT7xKWWUkOlsxrR6MW-6lEmrqw759KGqvxcHNSl2_7Msye3lerFz4LXNJrNJJupVg?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<h2>ファームウェア書き込み</h2>
<p>リポジトリを clone</p>
<div class="highlight"><pre><span></span>git clone https://github.com/qmk/qmk_firmware.git
</pre></div>


<p>ファームウェアのビルドに必要なパッケージ類をインストール(Linux)</p>
<div class="highlight"><pre><span></span>apt-get install gcc unzip wget zip gcc-avr binutils-avr avr-libc dfu-programmer dfu-util gcc-arm-none-eabi binutils-arm-none-eabi libnewlib-arm-none-eabi
</pre></div>


<p>デフォルトのレイアウトを書き込む</p>
<div class="highlight"><pre><span></span>$ make lets_split/rev2:default
</pre></div>


<div class="highlight"><pre><span></span>$ sudo make lets_split/rev2:default:avrdude
QMK Firmware <span class="m">0</span>.5.207
Making lets_split/rev2 with keymap default and target avrdude

avr-gcc <span class="o">(</span>GCC<span class="o">)</span> <span class="m">4</span>.9.2
Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">2014</span> Free Software Foundation, Inc.
This is free software<span class="p">;</span> see the <span class="nb">source</span> <span class="k">for</span> copying conditions.  There is NO
warranty<span class="p">;</span> not even <span class="k">for</span> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Size before:
   text    data     bss     dec     hex filename
      <span class="m">0</span>   <span class="m">18850</span>       <span class="m">0</span>   <span class="m">18850</span>    49a2 ./.build/lets_split_rev2_default.hex

Compiling: ./tmk_core/common/command.c                                                              <span class="o">[</span>OK<span class="o">]</span>
Linking: .build/lets_split_rev2_default.elf                                                         <span class="o">[</span>OK<span class="o">]</span>
Creating load file <span class="k">for</span> flashing: .build/lets_split_rev2_default.hex                                 <span class="o">[</span>OK<span class="o">]</span>
Checking file size of lets_split_rev2_default.hex                                                   <span class="o">[</span>OK<span class="o">]</span>
 * File size is fine - <span class="m">18850</span>/28672
Detecting USB port, reset your controller now...........
Detected controller on USB port at /dev/ttyACM0

Connecting to programmer: .
Found programmer: <span class="nv">Id</span> <span class="o">=</span> <span class="s2">&quot;CATERIN&quot;</span><span class="p">;</span> <span class="nb">type</span> <span class="o">=</span> S
    Software <span class="nv">Version</span> <span class="o">=</span> <span class="m">1</span>.0<span class="p">;</span> No Hardware Version given.
Programmer supports auto addr increment.
Programmer supports buffered memory access with <span class="nv">buffersize</span><span class="o">=</span><span class="m">128</span> bytes.

Programmer supports the following devices:
    Device code: 0x44

avrdude: AVR device initialized and ready to accept instructions

Reading <span class="p">|</span> <span class="c1">################################################## | 100% 0.00s</span>

avrdude: Device <span class="nv">signature</span> <span class="o">=</span> 0x1e9587 <span class="o">(</span>probably m32u4<span class="o">)</span>
avrdude: NOTE: <span class="s2">&quot;flash&quot;</span> memory has been specified, an erase cycle will be performed
         To disable this feature, specify the -D option.
avrdude: erasing chip
avrdude: reading input file <span class="s2">&quot;./.build/lets_split_rev2_default.hex&quot;</span>
avrdude: input file ./.build/lets_split_rev2_default.hex auto detected as Intel Hex
avrdude: writing flash <span class="o">(</span><span class="m">18850</span> bytes<span class="o">)</span>:

Writing <span class="p">|</span> <span class="c1">################################################## | 100% 1.41s</span>

avrdude: <span class="m">18850</span> bytes of flash written
avrdude: verifying flash memory against ./.build/lets_split_rev2_default.hex:
avrdude: load data flash data from input file ./.build/lets_split_rev2_default.hex:
avrdude: input file ./.build/lets_split_rev2_default.hex auto detected as Intel Hex
avrdude: input file ./.build/lets_split_rev2_default.hex contains <span class="m">18850</span> bytes
avrdude: reading on-chip flash data:

Reading <span class="p">|</span> <span class="c1">################################################## | 100% 0.14s</span>

avrdude: verifying ...
avrdude: <span class="m">18850</span> bytes of flash verified

avrdude: safemode: Fuses OK <span class="o">(</span>E:CB, H:D8, L:FF<span class="o">)</span>

avrdude <span class="k">done</span>.  Thank you.
</pre></div>


<p>途中で<code>reset your controller now</code>と出るので GND と RST をショートしたスイッチを押す。1 回で認識しない場合は何回か押す。</p>
<p>書き込みが成功すると上記のようなログが出る。左手と右手両方とも書き込む。
USB 接続し、TRRS ソケットで繋げて全部のキーが動作するか確認。ハンダ付けが甘いと微妙に認識しづらいキーがあるので直しておく。</p>
<h3>LED の設定</h3>
<p><code>vim keyboards/lets_split/keymaps/default/rules.mk</code></p>
<p><code>rules.mk</code>に以下の行を追加</p>
<div class="highlight"><pre><span></span>RGBLIGHT_ENABLE = yes
</pre></div>


<p>キーマップを修正する</p>
<div class="highlight"><pre><span></span>vim keyboards/lets_split/keymaps/default/keymap.c
</pre></div>


<p>UNDERGLOW 用のレイヤーを定義</p>
<div class="highlight"><pre><span></span>#define UNDERGLOW_LAYER 6
</pre></div>


<p>キーマップを追加</p>
<div class="highlight"><pre><span></span>[UNDERGLOW_LAYER] = KEYMAP( \
  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______, \
  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______, \
  _______,  RGB_TOG,  RGB_MOD,  RGB_HUD,  RGB_HUI,  RGB_SAD,  RGB_SAI,  RGB_VAD,  RGB_VAI,  _______,  _______,  _______, \
  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______,  _______ \
),
</pre></div>


<p>QWERTY レイヤーのどこかのキーに<code>MO(UNDERGLOW_LAYER)</code>を割り当て</p>
<p>再度ファームウェア書き込みの時と同じ手順でキーマップを Flash し<code>MO(UNDERGLOW_LAYER)</code>でレイヤーを切り替えて<code>RGB_TOG</code>で LED が光ることを確認する。また<code>RGB_MOD</code>で発光パターンを色々切り替えられる。</p>
<p>以降もキーマップを変えたい場合は<code>keymap.c</code>を編集して変えることが出来る。</p>
<h2>完成</h2>
<p>こんな感じでなんとか完成。</p>
<p><img src="https://u6ixvg.ch.files.1drv.com/y4mLfKNMawH4ubEowYh-8FARCykY9b6eRKWdZ8hw_eEJcNoQT-yXqxYvspmdnUjZnJydyewy-7r6tOh2eBF7eT2971-Q1w9lGMJ4AU_ujoGQcUUSkbYehZXST-aJJFCBexTGC06YIosebBsTnmP0fGPmUb_lcxbQm-mIh-j9a2A4ywTrDKPF3n4uF3eWtMc-pFzYYk2WDYqogjASzkWcFoOrw?width=4160&height=3120&cropmode=none" width="4160" height="3120" /></p>
<p>キーキャップは<a href="http://www.mechsupply.co.uk/product/devlin-k-series-aurora-planck-keyset">DEVLIN K-SERIES AURORA</a>にした。</p>
<h2>感想</h2>
<p>パーツが揃ったり揃わなかったり、10 数年ぶりのハンダ付けに苦労したりと結構時間かかったけど初自作キーボードなのでやっぱりなんとなく愛着が湧く。キーマップを色々いじって自分好みの配列にしてみたい。</p>
<h2>参考資料</h2>
<ul>
<li><a href="https://github.com/nicinabox/lets-split-guide/blob/master/assembly.md">lets-split-guide/assembly.md at master · nicinabox/lets-split-guide</a></li>
<li><a href="http://pppurple.hatenablog.com/entry/2017/09/24/193635">Let's split を作る(製作編) - abcdefg.....</a></li>
<li><a href="https://qiita.com/kzmake/items/443478763cdeaedcfd0a">分離型のコンパクトなキーボード let's split(レツプリ)を組み立てた話 - Qiita</a></li>
<li><a href="http://riv-mk.hateblo.jp/entry/pro_micro_and_qmk">Pro Micro &amp; QMK Firmware のセットアップガイド (Let's Split 編) - Voxel Highway</a></li>
<li><a href="http://yhara.jp/LetsSplit">レツプリ他自作キーボードまとめ - yhara.jp</a></li>
<li><a href="https://yushakobo.jp/pluis9/2017/07/lets-split-fes/">Let's Split を組み立てた話 | 遊舎工房</a></li>
<li><a href="https://docs.qmk.fm/getting_started_build_tools.html">Install Build Tools · QMK Firmware</a></li>
</ul>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Let's Split (レツプリ) を組み立てた&amp;url=http://shufo.github.io/build-lets-split.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://shufo.github.io/build-lets-split.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=http://shufo.github.io/build-lets-split.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="http://shufo.github.io/tag/diy">DIY</a><a href="http://shufo.github.io/tag/keyboard">keyboard</a><a href="http://shufo.github.io/tag/zi-zuo-kibodo">自作キーボード</a>                </aside>

                <div class="clear"></div>

                <aside class="post-author">
                        <figure class="post-author-avatar">
                            <img src="https://avatars1.githubusercontent.com/u/1641039?s=400&u=e76a7e80d95805075226c95b7fc576ac0df4b6f1&v=4" alt="Shufo" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="http://shufo.github.io/author/shufo">Shufo</a></h4>
                            <span class="post-author-location"><i class="ic ic-location"></i> Tokyo</span>
                            <span class="post-author-website"><a href="http://github.com/shufo"><i class="ic ic-link"></i> Website</a></span>
                    </div>
                    <div class="clear"></div>
                </aside>
 

                </section>

                <script type="text/javascript">
                    var disqus = 'shufo';
                    var disqus_shortname = 'shufo';
                    var disqus_identifier = '/build-lets-split.html';
                    var disqus_url = 'http://shufo.github.io/build-lets-split.html';
                </script>
                <noscript>Please enable JavaScript to view the comments.</noscript>                  
                <section class="post-comments">
                        <a id="show-disqus" class="post-comments-activate" data-disqus-identifier="/build-lets-split.html" >Show Comments</a>
                    <div id="disqus_thread"></div>                  
                </section>

                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">
          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script type="text/javascript" src="http://shufo.github.io/theme/js/script.js"></script>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1113986-11']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'shufo';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>